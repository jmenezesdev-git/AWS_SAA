#!/usr/bin/env bash
set -e

config_path="$(realpath .)/samconfig.toml"

if [ ! -f "$config_path" ]; then
    echo "$config_path does not exist."
    exit 1
fi

echo "__SAM deploy"
echo "loading config $config_path"

sam deploy \
    --template-file "./.aws-sam/build/packaged.yaml" \
    --stack-name "eth-container-lambda-py" \
    --capabilities "CAPABILITY_IAM" \
    --config-file "$config_path" 