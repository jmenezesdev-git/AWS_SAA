#!/usr/bin/env bash
set -e

template_path="$(realpath .)/.aws-sam/build/template.yaml"
output_template_path="$(realpath .)/.aws-sam/build/packaged.yaml"
config_path="$(realpath .)/samconfig.toml"

if [ ! -f "$config_path" ]; then
    echo "$config_path does not exist."
    exit 1
fi

if [ ! -f "$template_path" ]; then
    echo "$template_path does not exist."
    exit 1
fi

echo "__SAM package"

sam package \
--config-file "$config_path" \
--template-file "$template_path" \
--output-template-file "$output_template_path" \
--s3-prefix "container-python"